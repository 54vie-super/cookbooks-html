"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[329],{3727(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"api/miniapp-sdk/hooks","title":"Hooks API","description":"React hooks for accessing host app services from mini-apps","source":"@site/docs/api/miniapp-sdk/hooks.md","sourceDirName":"api/miniapp-sdk","slug":"/api/miniapp-sdk/hooks","permalink":"/api/miniapp-sdk/hooks","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/api/miniapp-sdk/hooks.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Hooks API","sidebar_position":1,"description":"React hooks for accessing host app services from mini-apps"},"sidebar":"apiSidebar","previous":{"title":"Experiments & Feature Flags","permalink":"/api/analytics/experiments"},"next":{"title":"Services API","permalink":"/api/miniapp-sdk/services"}}');var s=t(5178),r=t(8145);const c={title:"Hooks API",sidebar_position:1,description:"React hooks for accessing host app services from mini-apps"},d="Hooks API",o={},a=[{value:"useHostAuth",id:"usehostauth",level:2},{value:"TypeScript Interface",id:"typescript-interface",level:3},{value:"Return Value",id:"return-value",level:3},{value:"Example",id:"example",level:3},{value:"useHostDevice",id:"usehostdevice",level:2},{value:"TypeScript Interface",id:"typescript-interface-1",level:3},{value:"Return Value",id:"return-value-1",level:3},{value:"Example",id:"example-1",level:3},{value:"useHostStorage",id:"usehoststorage",level:2},{value:"TypeScript Interface",id:"typescript-interface-2",level:3},{value:"Return Value",id:"return-value-2",level:3},{value:"Example",id:"example-2",level:3},{value:"useHostAnalytics",id:"usehostanalytics",level:2},{value:"TypeScript Interface",id:"typescript-interface-3",level:3},{value:"Return Value",id:"return-value-3",level:3},{value:"Example",id:"example-3",level:3},{value:"useHostPush",id:"usehostpush",level:2},{value:"TypeScript Interface",id:"typescript-interface-4",level:3},{value:"Return Value",id:"return-value-4",level:3},{value:"Example",id:"example-4",level:3},{value:"Hook Dependencies",id:"hook-dependencies",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"hooks-api",children:"Hooks API"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@54vie/miniapp-sdk"})," provides React hooks that allow mini-apps to interact with host app services in a declarative way. All hooks automatically handle cleanup and state synchronization."]}),"\n",(0,s.jsx)(n.h2,{id:"usehostauth",children:"useHostAuth"}),"\n",(0,s.jsx)(n.p,{children:"Access authentication state and methods from the host app."}),"\n",(0,s.jsx)(n.h3,{id:"typescript-interface",children:"TypeScript Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface User {\n  id: string;\n  name: string;\n  avatar?: string;\n  phone?: string;\n  email?: string;\n}\n\ninterface HostAuthState {\n  /** Current authenticated user object, null if not logged in */\n  user: User | null;\n  /** Whether the user is currently authenticated */\n  isAuthenticated: boolean;\n  /** Get a fresh access token for API calls */\n  getAccessToken: () => Promise<string>;\n}\n\nfunction useHostAuth(): HostAuthState;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"return-value",children:"Return Value"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"user"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"User | null"})}),(0,s.jsx)(n.td,{children:"Current user object or null if not authenticated"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isAuthenticated"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"Whether the user is logged in"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getAccessToken"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<string>"})}),(0,s.jsx)(n.td,{children:"Async function to retrieve a valid JWT token"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useHostAuth } from '@54vie/miniapp-sdk';\n\nfunction ProfileScreen() {\n  const { user, isAuthenticated, getAccessToken } = useHostAuth();\n\n  const fetchUserData = async () => {\n    const token = await getAccessToken();\n    const response = await fetch('/api/user/profile', {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    return response.json();\n  };\n\n  if (!isAuthenticated) {\n    return <Text>Please login to continue</Text>;\n  }\n\n  return (\n    <View>\n      <Text>Welcome, {user?.name}!</Text>\n      <Text>Email: {user?.email}</Text>\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usehostdevice",children:"useHostDevice"}),"\n",(0,s.jsx)(n.p,{children:"Access device information and hardware capabilities."}),"\n",(0,s.jsx)(n.h3,{id:"typescript-interface-1",children:"TypeScript Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface DeviceInfo {\n  deviceId: string;\n  deviceName: string;\n  platform: 'ios' | 'android';\n  model: string;\n  brand: string;\n  osVersion: string;\n  appVersion: string;\n  buildNumber: string;\n  isEmulator: boolean;\n  isTablet: boolean;\n}\n\ninterface BatteryInfo {\n  level: number;       // 0-100\n  isCharging: boolean;\n  isLowPowerMode: boolean;\n}\n\ninterface HostDeviceState {\n  info: DeviceInfo | null;\n  battery: BatteryInfo | null;\n  isLoading: boolean;\n  error: Error | null;\n}\n\ninterface UseHostDeviceReturn extends HostDeviceState {\n  /** Refresh device information */\n  refresh: () => Promise<void>;\n  /** Get unique device ID */\n  getDeviceId: () => Promise<string>;\n  /** Get unique installation ID */\n  getUniqueId: () => Promise<string>;\n  /** Get mobile carrier name */\n  getCarrier: () => Promise<string | null>;\n  /** Check if device is a tablet */\n  isTablet: () => Promise<boolean>;\n  /** Check if running on emulator/simulator */\n  isEmulator: () => Promise<boolean>;\n}\n\nfunction useHostDevice(): UseHostDeviceReturn;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"return-value-1",children:"Return Value"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"info"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DeviceInfo | null"})}),(0,s.jsx)(n.td,{children:"Complete device information"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"battery"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"BatteryInfo | null"})}),(0,s.jsx)(n.td,{children:"Battery status information"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isLoading"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"Loading state"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"error"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Error | null"})}),(0,s.jsx)(n.td,{children:"Error if fetch failed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"refresh"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Refresh all device info"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getDeviceId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<string>"})}),(0,s.jsx)(n.td,{children:"Get device identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getUniqueId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<string>"})}),(0,s.jsx)(n.td,{children:"Get installation identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"getCarrier"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<string | null>"})}),(0,s.jsx)(n.td,{children:"Get carrier name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isTablet"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<boolean>"})}),(0,s.jsx)(n.td,{children:"Check if tablet"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isEmulator"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<boolean>"})}),(0,s.jsx)(n.td,{children:"Check if emulator"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useHostDevice } from '@54vie/miniapp-sdk';\n\nfunction DeviceInfoComponent() {\n  const { info, battery, isLoading, refresh } = useHostDevice();\n\n  if (isLoading) return <ActivityIndicator />;\n\n  return (\n    <View>\n      <Text>Brand: {info?.brand}</Text>\n      <Text>Model: {info?.model}</Text>\n      <Text>OS: {info?.platform} {info?.osVersion}</Text>\n      <Text>Battery: {battery?.level}%</Text>\n      {battery?.isCharging && <Text>Charging</Text>}\n      <Button title=\"Refresh\" onPress={refresh} />\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usehoststorage",children:"useHostStorage"}),"\n",(0,s.jsx)(n.p,{children:"Access isolated key-value storage scoped to the mini-app."}),"\n",(0,s.jsx)(n.h3,{id:"typescript-interface-2",children:"TypeScript Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface HostStorageState {\n  /** Get a value by key */\n  get: <T>(key: string) => Promise<T | null>;\n  /** Set a value for a key */\n  set: <T>(key: string, value: T) => Promise<void>;\n  /** Remove a value by key */\n  remove: (key: string) => Promise<void>;\n  /** Clear all storage for this mini-app */\n  clear: () => Promise<void>;\n}\n\nfunction useHostStorage(): HostStorageState;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"return-value-2",children:"Return Value"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"get<T>"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(key: string) => Promise<T | null>"})}),(0,s.jsx)(n.td,{children:"Retrieve a stored value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"set<T>"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(key: string, value: T) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Store a value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"remove"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(key: string) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Remove a stored value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clear"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Clear all mini-app storage"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-2",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useHostStorage } from '@54vie/miniapp-sdk';\nimport { useState, useEffect } from 'react';\n\ninterface CartData {\n  items: Array<{ id: string; qty: number }>;\n}\n\nfunction ShoppingCart() {\n  const { get, set, remove } = useHostStorage();\n  const [cart, setCart] = useState<CartData | null>(null);\n\n  useEffect(() => {\n    loadCart();\n  }, []);\n\n  const loadCart = async () => {\n    const savedCart = await get<CartData>('cart');\n    setCart(savedCart);\n  };\n\n  const addItem = async (productId: string) => {\n    const newCart: CartData = {\n      items: [...(cart?.items || []), { id: productId, qty: 1 }],\n    };\n    await set('cart', newCart);\n    setCart(newCart);\n  };\n\n  const clearCart = async () => {\n    await remove('cart');\n    setCart(null);\n  };\n\n  return (\n    <View>\n      <Text>Items in cart: {cart?.items.length || 0}</Text>\n      <Button title=\"Clear Cart\" onPress={clearCart} />\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Storage Scope",type:"info",children:(0,s.jsx)(n.p,{children:"Each mini-app has its own isolated storage namespace. Data from one mini-app cannot be accessed by another."})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usehostanalytics",children:"useHostAnalytics"}),"\n",(0,s.jsx)(n.p,{children:"Track analytics events and screen views."}),"\n",(0,s.jsx)(n.h3,{id:"typescript-interface-3",children:"TypeScript Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface HostAnalyticsState {\n  /** Track a custom event with optional properties */\n  trackEvent: (name: string, properties?: Record<string, unknown>) => void;\n  /** Track a screen view */\n  trackScreen: (screenName: string) => void;\n}\n\nfunction useHostAnalytics(): HostAnalyticsState;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"return-value-3",children:"Return Value"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"trackEvent"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(name: string, properties?: Record<string, unknown>) => void"})}),(0,s.jsx)(n.td,{children:"Track custom event"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"trackScreen"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(screenName: string) => void"})}),(0,s.jsx)(n.td,{children:"Track screen view"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-3",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useHostAnalytics } from '@54vie/miniapp-sdk';\nimport { useEffect } from 'react';\n\nfunction ProductDetailScreen({ productId }: { productId: string }) {\n  const { trackEvent, trackScreen } = useHostAnalytics();\n\n  useEffect(() => {\n    trackScreen('ProductDetail');\n    trackEvent('product_viewed', {\n      productId,\n      timestamp: Date.now(),\n    });\n  }, [productId]);\n\n  const handleAddToCart = () => {\n    trackEvent('add_to_cart', {\n      productId,\n      quantity: 1,\n      source: 'product_detail',\n    });\n    // Add to cart logic\n  };\n\n  const handlePurchase = (amount: number) => {\n    trackEvent('purchase_completed', {\n      productId,\n      amount,\n      currency: 'VND',\n    });\n  };\n\n  return (\n    <View>\n      <Button title=\"Add to Cart\" onPress={handleAddToCart} />\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Attribution",type:"note",children:(0,s.jsx)(n.p,{children:"All events from mini-apps are automatically attributed to the mini-app ID for analytics purposes."})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usehostpush",children:"useHostPush"}),"\n",(0,s.jsx)(n.p,{children:"Manage push notifications and local notifications."}),"\n",(0,s.jsx)(n.h3,{id:"typescript-interface-4",children:"TypeScript Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface LocalNotification {\n  id?: string;\n  title: string;\n  body: string;\n  data?: Record<string, unknown>;\n  /** Schedule date (ISO string or timestamp) */\n  fireDate?: string | number;\n  /** Repeat interval */\n  repeatType?: 'minute' | 'hour' | 'day' | 'week' | 'month';\n  /** Badge number */\n  badge?: number;\n  /** Sound name */\n  sound?: string;\n  /** Android channel ID */\n  channelId?: string;\n}\n\ninterface HostPushState {\n  token: string | null;\n  hasPermission: boolean;\n  badgeCount: number;\n  isLoading: boolean;\n  error: Error | null;\n}\n\ninterface UseHostPushReturn extends HostPushState {\n  /** Refresh push notification state */\n  refresh: () => Promise<void>;\n  /** Request notification permission */\n  requestPermission: () => Promise<boolean>;\n  /** Set app badge count */\n  setBadgeCount: (count: number) => Promise<void>;\n  /** Clear app badge */\n  clearBadge: () => Promise<void>;\n  /** Subscribe to a topic (FCM) */\n  subscribeToTopic: (topic: string) => Promise<void>;\n  /** Unsubscribe from a topic */\n  unsubscribeFromTopic: (topic: string) => Promise<void>;\n  /** Schedule a local notification */\n  scheduleNotification: (notification: LocalNotification) => Promise<string>;\n  /** Cancel a scheduled notification */\n  cancelNotification: (notificationId: string) => Promise<void>;\n}\n\nfunction useHostPush(): UseHostPushReturn;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"return-value-4",children:"Return Value"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"token"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string | null"})}),(0,s.jsx)(n.td,{children:"FCM/APNs push token"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"hasPermission"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"Whether notification permission is granted"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"badgeCount"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"Current app badge count"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isLoading"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"Loading state"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"error"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Error | null"})}),(0,s.jsx)(n.td,{children:"Error if any operation failed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"refresh"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Refresh push state"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"requestPermission"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<boolean>"})}),(0,s.jsx)(n.td,{children:"Request notification permission"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"setBadgeCount"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(count: number) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Set badge count"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clearBadge"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"() => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Clear badge"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"subscribeToTopic"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(topic: string) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Subscribe to FCM topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unsubscribeFromTopic"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(topic: string) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Unsubscribe from topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"scheduleNotification"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(notification: LocalNotification) => Promise<string>"})}),(0,s.jsx)(n.td,{children:"Schedule local notification"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cancelNotification"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"(notificationId: string) => Promise<void>"})}),(0,s.jsx)(n.td,{children:"Cancel scheduled notification"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-4",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useHostPush } from '@54vie/miniapp-sdk';\n\nfunction NotificationSettings() {\n  const {\n    token,\n    hasPermission,\n    badgeCount,\n    isLoading,\n    requestPermission,\n    subscribeToTopic,\n    scheduleNotification,\n    clearBadge,\n  } = useHostPush();\n\n  const handleEnableNotifications = async () => {\n    const granted = await requestPermission();\n    if (granted && token) {\n      // Send token to your server\n      await api.registerDevice(token);\n      // Subscribe to topics\n      await subscribeToTopic('promotions');\n      await subscribeToTopic('order_updates');\n    }\n  };\n\n  const scheduleReminder = async () => {\n    const notificationId = await scheduleNotification({\n      title: 'Reminder',\n      body: 'Your order is ready for pickup!',\n      fireDate: Date.now() + 3600000, // 1 hour from now\n      sound: 'default',\n      data: { orderId: '12345' },\n    });\n    console.log('Scheduled notification:', notificationId);\n  };\n\n  if (isLoading) return <ActivityIndicator />;\n\n  return (\n    <View>\n      <Text>Notifications: {hasPermission ? 'Enabled' : 'Disabled'}</Text>\n      <Text>Badge Count: {badgeCount}</Text>\n\n      {!hasPermission && (\n        <Button\n          title=\"Enable Notifications\"\n          onPress={handleEnableNotifications}\n        />\n      )}\n\n      <Button title=\"Schedule Reminder\" onPress={scheduleReminder} />\n      <Button title=\"Clear Badge\" onPress={clearBadge} />\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"hook-dependencies",children:"Hook Dependencies"}),"\n",(0,s.jsx)(n.p,{children:"All hooks use the bridge communication layer to interact with the host app:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"useHostAuth      -> bridge.send('auth.getAccessToken')\nuseHostDevice    -> bridge.send('device.getInfo')\nuseHostStorage   -> bridge.send('storage.get', 'storage.set', ...)\nuseHostAnalytics -> bridge.emit('analytics.track', 'analytics.screen')\nuseHostPush      -> bridge.send('push.getToken', 'push.requestPermission', ...)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For more information on the bridge protocol, see the ",(0,s.jsx)(n.a,{href:"/api/miniapp-sdk/bridge",children:"Bridge API documentation"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8145(e,n,t){t.d(n,{R:()=>c,x:()=>d});var i=t(5410);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);