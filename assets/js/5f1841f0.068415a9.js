"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[462],{6887(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"modules/miniapp-sdk","title":"miniapp-sdk","description":"SDK that provides APIs for mini-apps to communicate with the host app through the bridge protocol.","source":"@site/docs/modules/miniapp-sdk.md","sourceDirName":"modules","slug":"/modules/miniapp-sdk","permalink":"/modules/miniapp-sdk","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/modules/miniapp-sdk.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"miniapp-sdk"},"sidebar":"mainSidebar","previous":{"title":"@54vie/storage","permalink":"/modules/storage"},"next":{"title":"miniapp-runtime","permalink":"/modules/miniapp-runtime"}}');var s=i(5178),a=i(8145);const o={sidebar_position:4,title:"miniapp-sdk"},r="miniapp-sdk - SDK for Mini-Apps",c={},l=[{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Authentication",id:"authentication",level:2},{value:"useHostAuth",id:"usehostauth",level:3},{value:"API with Auth",id:"api-with-auth",level:3},{value:"Storage",id:"storage",level:2},{value:"Device Information",id:"device-information",level:2},{value:"useHostDevice",id:"usehostdevice",level:3},{value:"Direct Access",id:"direct-access",level:3},{value:"Network Status",id:"network-status",level:2},{value:"Analytics",id:"analytics",level:2},{value:"Push Notifications",id:"push-notifications",level:2},{value:"Location",id:"location",level:2},{value:"Media",id:"media",level:2},{value:"UI Services",id:"ui-services",level:2},{value:"Toast",id:"toast",level:3},{value:"Alert",id:"alert",level:3},{value:"Action Sheet",id:"action-sheet",level:3},{value:"Haptics",id:"haptics",level:2},{value:"Clipboard",id:"clipboard",level:2},{value:"Share",id:"share",level:2},{value:"Navigation",id:"navigation",level:2},{value:"API Requests",id:"api-requests",level:2},{value:"Permissions",id:"permissions",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"miniapp-sdk---sdk-for-mini-apps",children:"miniapp-sdk - SDK for Mini-Apps"})}),"\n",(0,s.jsx)(n.p,{children:"SDK that provides APIs for mini-apps to communicate with the host app through the bridge protocol."}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pnpm add @54vie/miniapp-sdk\n"})}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {\n  useHostAuth,\n  useHostDevice,\n  storage,\n  analytics,\n} from '@54vie/miniapp-sdk';\n\nfunction MiniApp() {\n  const { user, isAuthenticated } = useHostAuth();\n  const { deviceInfo } = useHostDevice();\n\n  useEffect(() => {\n    analytics.screen('MiniAppHome');\n  }, []);\n\n  if (!isAuthenticated) {\n    return <LoginPrompt />;\n  }\n\n  return <MainContent user={user} />;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,s.jsx)(n.h3,{id:"usehostauth",children:"useHostAuth"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostAuth } from '@54vie/miniapp-sdk';\n\nfunction ProfileScreen() {\n  const {\n    user,              // Current user object\n    isAuthenticated,   // Boolean\n    isLoading,         // Loading state\n    accessToken,       // JWT token for API calls\n    requestLogin,      // Trigger host login flow\n    checkPermission,   // Check specific permission\n  } = useHostAuth();\n\n  if (!isAuthenticated) {\n    return (\n      <View>\n        <Text>Please login to continue</Text>\n        <Button onPress={requestLogin}>Login</Button>\n      </View>\n    );\n  }\n\n  return (\n    <View>\n      <Text>Welcome, {user.name}!</Text>\n      <Text>Email: {user.email}</Text>\n    </View>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"api-with-auth",children:"API with Auth"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostAuth, api } from '@54vie/miniapp-sdk';\n\nfunction OrderList() {\n  const { accessToken } = useHostAuth();\n\n  const fetchOrders = async () => {\n    // Token is automatically injected by the bridge\n    const orders = await api.get('/orders');\n    return orders;\n  };\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"storage",children:"Storage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { storage } from '@54vie/miniapp-sdk';\n\n// Get value\nconst value = await storage.get('my-key');\n\n// Set value\nawait storage.set('my-key', { data: 'value' });\n\n// Remove\nawait storage.remove('my-key');\n\n// Clear all (within mini-app scope)\nawait storage.clear();\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Storage Scope",type:"info",children:(0,s.jsx)(n.p,{children:"Each mini-app has its own isolated storage namespace. Data from one mini-app cannot be accessed by another."})}),"\n",(0,s.jsx)(n.h2,{id:"device-information",children:"Device Information"}),"\n",(0,s.jsx)(n.h3,{id:"usehostdevice",children:"useHostDevice"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import { useHostDevice } from \'@54vie/miniapp-sdk\';\n\nfunction MyComponent() {\n  const {\n    model,        // "iPhone 15 Pro"\n    brand,        // "Apple"\n    os,           // "ios" | "android"\n    osVersion,    // "17.0"\n    appVersion,   // "1.0.0"\n    isEmulator,   // Boolean\n    isTablet,     // Boolean\n  } = useHostDevice();\n\n  return (\n    <Text>Running on {brand} {model}</Text>\n  );\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"direct-access",children:"Direct Access"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { device } from '@54vie/miniapp-sdk';\n\nconst info = await device.getInfo();\nconst deviceId = await device.getDeviceId();\nconst isEmulator = await device.isEmulator();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"network-status",children:"Network Status"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostNetwork, network } from '@54vie/miniapp-sdk';\n\n// Hook\nfunction MyComponent() {\n  const {\n    isOnline,\n    isWifi,\n    isCellular,\n    connectionType,  // 'wifi' | 'cellular' | 'none'\n  } = useHostNetwork();\n\n  if (!isOnline) {\n    return <OfflineMessage />;\n  }\n}\n\n// Direct\nconst isOnline = await network.isOnline();\nconst type = await network.getConnectionType();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"analytics",children:"Analytics"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { analytics } from '@54vie/miniapp-sdk';\n\n// Track event\nanalytics.track('button_clicked', {\n  button_name: 'checkout',\n  product_id: '123',\n});\n\n// Track screen\nanalytics.screen('ProductDetail', {\n  product_id: '123',\n});\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Attribution",type:"note",children:(0,s.jsx)(n.p,{children:"All events from mini-apps are automatically attributed to the mini-app ID for analytics purposes."})}),"\n",(0,s.jsx)(n.h2,{id:"push-notifications",children:"Push Notifications"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostPush, push } from '@54vie/miniapp-sdk';\n\n// Hook\nfunction NotificationSettings() {\n  const {\n    hasPermission,\n    token,\n    requestPermission,\n  } = useHostPush();\n\n  if (!hasPermission) {\n    return (\n      <Button onPress={requestPermission}>\n        Enable Notifications\n      </Button>\n    );\n  }\n}\n\n// Direct\nconst token = await push.getToken();\nawait push.subscribeToTopic('promotions');\nawait push.scheduleNotification({\n  title: 'Reminder',\n  body: 'Your order is ready!',\n  scheduledAt: new Date(Date.now() + 3600000),\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"location",children:"Location"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostLocation, location } from '@54vie/miniapp-sdk';\n\n// Hook\nfunction NearbyStores() {\n  const {\n    currentLocation,\n    isLoading,\n    error,\n    hasPermission,\n    requestPermission,\n  } = useHostLocation();\n\n  if (!hasPermission) {\n    return <Button onPress={requestPermission}>Allow Location</Button>;\n  }\n\n  if (isLoading) return <Loading />;\n\n  return <StoreList location={currentLocation} />;\n}\n\n// Direct\nconst position = await location.getCurrentPosition();\nconst address = await location.reverseGeocode(position.latitude, position.longitude);\nconst places = await location.searchPlaces('coffee shop', position);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"media",children:"Media"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { media } from '@54vie/miniapp-sdk';\n\n// Take photo\nconst photo = await media.takePhoto({\n  quality: 'high',\n  cameraType: 'back',\n});\n\n// Pick from gallery\nconst images = await media.pickImage({\n  multiple: true,\n  maxSelection: 5,\n});\n\n// Crop image\nconst cropped = await media.cropImage(photo.uri, {\n  width: 300,\n  height: 300,\n  aspectRatio: 1,\n});\n\n// Resize\nconst resized = await media.resizeImage(photo.uri, {\n  width: 800,\n  quality: 0.8,\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ui-services",children:"UI Services"}),"\n",(0,s.jsx)(n.h3,{id:"toast",children:"Toast"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { ui } from '@54vie/miniapp-sdk';\n\nui.showToast({\n  message: 'Saved successfully!',\n  type: 'success',\n});\n\nui.showToast({\n  message: 'Something went wrong',\n  type: 'error',\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"alert",children:"Alert"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { ui } from '@54vie/miniapp-sdk';\n\nconst result = await ui.showAlert({\n  title: 'Confirm',\n  message: 'Are you sure you want to delete?',\n  buttons: [\n    { text: 'Cancel', style: 'cancel' },\n    { text: 'Delete', style: 'destructive' },\n  ],\n});\n\nif (result === 1) {\n  // User pressed Delete\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"action-sheet",children:"Action Sheet"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { ui } from '@54vie/miniapp-sdk';\n\nconst result = await ui.showActionSheet({\n  title: 'Choose action',\n  options: [\n    { label: 'Share', icon: 'share' },\n    { label: 'Edit', icon: 'edit' },\n    { label: 'Delete', icon: 'trash', destructive: true },\n  ],\n  cancelLabel: 'Cancel',\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"haptics",children:"Haptics"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { haptics } from '@54vie/miniapp-sdk';\n\n// Impact feedback\nhaptics.impact('light');   // light, medium, heavy\nhaptics.impact('medium');\n\n// Notification feedback\nhaptics.notification('success');  // success, warning, error\n\n// Selection feedback\nhaptics.selection();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"clipboard",children:"Clipboard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { clipboard } from '@54vie/miniapp-sdk';\n\n// Copy\nawait clipboard.setString('Hello World');\n\n// Paste\nconst text = await clipboard.getString();\n\n// Check\nconst hasContent = await clipboard.hasString();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"share",children:"Share"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { share } from '@54vie/miniapp-sdk';\n\n// Share text\nawait share.text({\n  message: 'Check out this product!',\n  url: 'https://54vie.vn/product/123',\n  title: 'Share Product',\n});\n\n// Share image\nawait share.image({\n  imageUrl: 'file:///path/to/image.jpg',\n  message: 'My photo',\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"navigation",children:"Navigation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { navigation } from '@54vie/miniapp-sdk';\n\n// Navigate to host screen\nnavigation.navigate('Wallet');\n\n// Go back\nnavigation.goBack();\n\n// Open another mini-app\nnavigation.openMiniApp('com.54vie.booking', {\n  serviceId: '123',\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api-requests",children:"API Requests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { api } from '@54vie/miniapp-sdk';\n\n// Requests are proxied through host with auth\nconst products = await api.get('/products');\nconst order = await api.post('/orders', orderData);\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Rate Limiting",type:"caution",children:(0,s.jsx)(n.p,{children:"API requests from mini-apps are subject to rate limiting. Default is 100 requests per minute."})}),"\n",(0,s.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,s.jsxs)(n.p,{children:["Mini-apps must declare required permissions in ",(0,s.jsx)(n.code,{children:"manifest.json"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "appId": "com.54vie.shopping",\n  "name": "Shopping",\n  "permissions": [\n    "storage",\n    "analytics",\n    "push",\n    "location",\n    "camera"\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Check permission at runtime:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { useHostAuth } from '@54vie/miniapp-sdk';\n\nfunction CameraFeature() {\n  const { checkPermission, requestPermission } = useHostAuth();\n\n  const handleCamera = async () => {\n    const hasPermission = await checkPermission('camera');\n    if (!hasPermission) {\n      const granted = await requestPermission('camera', 'Need camera for scanning');\n      if (!granted) return;\n    }\n    // Use camera\n  };\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8145(e,n,i){i.d(n,{R:()=>o,x:()=>r});var t=i(5410);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);