"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[870],{3804(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"modules/app-host","title":"app-host","description":"The main host application of the 54VIE Super App, managing authentication, navigation, and bridge handlers.","source":"@site/docs/modules/app-host.md","sourceDirName":"modules","slug":"/modules/app-host","permalink":"/modules/app-host","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/modules/app-host.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"app-host"},"sidebar":"mainSidebar","previous":{"title":"miniapp-runtime","permalink":"/modules/miniapp-runtime"},"next":{"title":"@54vie/api","permalink":"/modules/api"}}');var r=i(5178),s=i(8145);const o={sidebar_position:6,title:"app-host"},a="app-host - Host Application",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Auth Module",id:"auth-module",level:3},{value:"Usage",id:"usage",level:3},{value:"Bridge Handlers",id:"bridge-handlers",level:2},{value:"Mini-Program Registry",id:"mini-program-registry",level:2},{value:"Bundle Manager",id:"bundle-manager",level:2},{value:"Navigation Structure",id:"navigation-structure",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"app-host---host-application",children:"app-host - Host Application"})}),"\n",(0,r.jsx)(n.p,{children:"The main host application of the 54VIE Super App, managing authentication, navigation, and bridge handlers."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"app-host"})," is the main React Native application, responsible for:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication"}),": Login, SSO, biometric, token management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Mini-program loading"}),": Dynamic loading from backend"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bridge handlers"}),": 17 service handlers for mini-apps"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Navigation"}),": Tab navigation, stack navigation"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsx)(n.h3,{id:"auth-module",children:"Auth Module"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"app-host/src/auth/\n\u251c\u2500\u2500 AuthProvider.tsx      # Context provider\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 AuthService.ts    # Login, register, logout\n\u2502   \u251c\u2500\u2500 SSOService.ts     # Google, Apple, Facebook\n\u2502   \u2514\u2500\u2500 BiometricService.ts\n\u251c\u2500\u2500 hooks/\n\u2502   \u251c\u2500\u2500 useAuth.ts        # Main auth hook\n\u2502   \u251c\u2500\u2500 useSSO.ts         # SSO hooks\n\u2502   \u2514\u2500\u2500 useBiometric.ts   # Biometric hooks\n\u2514\u2500\u2500 utils/\n    \u251c\u2500\u2500 TokenManager.ts   # JWT management\n    \u2514\u2500\u2500 SessionManager.ts # Session tracking\n"})}),"\n",(0,r.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { useAuth, useSSO, useBiometric } from '../auth';\n\nfunction LoginScreen() {\n  const { login, isLoading } = useAuth();\n  const { signInWithGoogle, signInWithApple } = useSSO();\n  const { authenticate: biometricAuth, isSupported } = useBiometric();\n\n  // Email login\n  const handleLogin = async () => {\n    await login({ email, password });\n  };\n\n  // SSO\n  const handleGoogleLogin = async () => {\n    await signInWithGoogle();\n  };\n\n  // Biometric\n  const handleBiometric = async () => {\n    if (isSupported) {\n      const success = await biometricAuth('Login with Face ID');\n      if (success) {\n        // Auto-login with stored credentials\n      }\n    }\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"bridge-handlers",children:"Bridge Handlers"}),"\n",(0,r.jsxs)(n.p,{children:["17 service handlers are registered in ",(0,r.jsx)(n.code,{children:"AppProviders.tsx"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Service"}),(0,r.jsx)(n.th,{children:"Methods"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"storage"})}),(0,r.jsx)(n.td,{children:"get, set, remove, clear"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"api"})}),(0,r.jsx)(n.td,{children:"request, registerApi, unregisterApi"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"auth"})}),(0,r.jsx)(n.td,{children:"getUser, isAuthenticated, getAccessToken, requestLogin"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"analytics"})}),(0,r.jsx)(n.td,{children:"track, screen"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"biometric"})}),(0,r.jsx)(n.td,{children:"isSupported, isEnabled, authenticate"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"push"})}),(0,r.jsx)(n.td,{children:"getToken, requestPermission, scheduleNotification"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"device"})}),(0,r.jsx)(n.td,{children:"getInfo, getDeviceId, isEmulator"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"network"})}),(0,r.jsx)(n.td,{children:"isOnline, getConnectionType"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"haptics"})}),(0,r.jsx)(n.td,{children:"impact, notification, selection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"clipboard"})}),(0,r.jsx)(n.td,{children:"getString, setString"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"location"})}),(0,r.jsx)(n.td,{children:"getCurrentPosition, geocode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"media"})}),(0,r.jsx)(n.td,{children:"takePhoto, pickImage, cropImage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ui"})}),(0,r.jsx)(n.td,{children:"showToast, showAlert, showActionSheet"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"share"})}),(0,r.jsx)(n.td,{children:"text, image"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"host"})}),(0,r.jsx)(n.td,{children:"getInfo"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"navigation"})}),(0,r.jsx)(n.td,{children:"navigate, goBack"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"mini-program-registry",children:"Mini-Program Registry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { MiniProgramRegistry } from '../services/MiniProgramRegistry';\n\n// Fetch available mini-programs\nconst programs = await MiniProgramRegistry.getMiniPrograms();\n\n// Get specific program\nconst program = await MiniProgramRegistry.getMiniProgram('dashboard');\n\n// Track launch\nawait MiniProgramRegistry.trackLaunch('dashboard');\n"})}),"\n",(0,r.jsx)(n.h2,{id:"bundle-manager",children:"Bundle Manager"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { BundleManager } from '../services/BundleManager';\n\n// Check if needs update\nconst needsUpdate = await BundleManager.needsUpdate(programInfo);\n\n// Install bundle\nawait BundleManager.installBundle(programInfo, (progress) => {\n  console.log(`Download: ${progress * 100}%`);\n});\n\n// Get local manifest URL\nconst manifestUrl = await BundleManager.getLocalManifestUrl('dashboard');\n"})}),"\n",(0,r.jsx)(n.h2,{id:"navigation-structure",children:"Navigation Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"MainNavigator\n\u251c\u2500\u2500 AuthStack (if not authenticated)\n\u2502   \u2514\u2500\u2500 SignInScreen\n\u2502\n\u2514\u2500\u2500 TabsNavigator (if authenticated)\n    \u251c\u2500\u2500 HomeTab\n    \u2502   \u2514\u2500\u2500 HomeScreen\n    \u251c\u2500\u2500 ServicesTab\n    \u2502   \u251c\u2500\u2500 ServicesScreen (mini-app grid)\n    \u2502   \u2514\u2500\u2500 MiniProgramScreen (dynamic)\n    \u2514\u2500\u2500 AccountTab\n        \u2514\u2500\u2500 AccountScreen\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8145(e,n,i){i.d(n,{R:()=>o,x:()=>a});var t=i(5410);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);