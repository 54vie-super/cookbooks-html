"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[397],{7614(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>v,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"guides/bridge-services","title":"Bridge Services","description":"Guide to using bridge services for communication between mini-app and host app.","source":"@site/docs/guides/bridge-services.md","sourceDirName":"guides","slug":"/guides/bridge-services","permalink":"/guides/bridge-services","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/guides/bridge-services.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Bridge Services"},"sidebar":"mainSidebar","previous":{"title":"Authentication","permalink":"/guides/authentication"},"next":{"title":"Analytics Tracking","permalink":"/guides/analytics-tracking"}}');var t=i(5178),s=i(8145);const o={sidebar_position:3,title:"Bridge Services"},a="Bridge Services Guide",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Using in Mini-App",id:"using-in-mini-app",level:2},{value:"Via SDK (Recommended)",id:"via-sdk-recommended",level:3},{value:"Direct serviceRouter (Advanced)",id:"direct-servicerouter-advanced",level:3},{value:"Available Services",id:"available-services",level:2},{value:"Storage Service",id:"storage-service",level:3},{value:"Auth Service",id:"auth-service",level:3},{value:"Analytics Service",id:"analytics-service",level:3},{value:"Device Service",id:"device-service",level:3},{value:"Network Service",id:"network-service",level:3},{value:"Location Service",id:"location-service",level:3},{value:"Media Service",id:"media-service",level:3},{value:"UI Service",id:"ui-service",level:3},{value:"Haptics Service",id:"haptics-service",level:3},{value:"Creating Custom Handlers (Host Side)",id:"creating-custom-handlers-host-side",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Use SDK over direct serviceRouter",id:"1-use-sdk-over-direct-servicerouter",level:3},{value:"2. Handle errors gracefully",id:"2-handle-errors-gracefully",level:3},{value:"3. Check permissions before using features",id:"3-check-permissions-before-using-features",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"bridge-services-guide",children:"Bridge Services Guide"})}),"\n",(0,t.jsx)(n.p,{children:"Guide to using bridge services for communication between mini-app and host app."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Bridge services allow mini-apps to safely access host app features through ",(0,t.jsx)(n.code,{children:"serviceRouter"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     serviceRouter     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Mini-App   \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502  Host App   \u2502\n\u2502             \u2502      invoke()         \u2502  Handlers   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-in-mini-app",children:"Using in Mini-App"}),"\n",(0,t.jsx)(n.h3,{id:"via-sdk-recommended",children:"Via SDK (Recommended)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import {\n  storage,\n  analytics,\n  device,\n  network,\n  location,\n  media,\n  push,\n  haptics,\n  clipboard,\n  ui,\n  share,\n} from '@54vie/miniapp-sdk';\n\n// Storage\nawait storage.set('key', value);\nconst data = await storage.get('key');\n\n// Analytics\nanalytics.track('event_name', { property: 'value' });\n\n// Device info\nconst info = await device.getInfo();\n\n// Network\nconst isOnline = await network.isOnline();\n\n// Location\nconst position = await location.getCurrentPosition();\n\n// Media\nconst photo = await media.takePhoto();\n\n// Push\nconst token = await push.getToken();\n\n// Haptics\nhaptics.notification('success');\n\n// Clipboard\nawait clipboard.setString('copied text');\n\n// UI\nui.showToast({ message: 'Success!', type: 'success' });\n\n// Share\nawait share.text({ message: 'Check this out!' });\n"})}),"\n",(0,t.jsx)(n.h3,{id:"direct-servicerouter-advanced",children:"Direct serviceRouter (Advanced)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { serviceRouter } from '@54vie/miniapp-sdk';\n\n// Invoke a service\nconst result = await serviceRouter.invoke('storage', 'get', {\n  key: 'my-key',\n  scope: 'my-miniapp',\n});\n\n// With error handling\ntry {\n  const user = await serviceRouter.invoke('auth', 'getUser');\n} catch (error) {\n  console.error('Failed to get user:', error);\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"available-services",children:"Available Services"}),"\n",(0,t.jsx)(n.h3,{id:"storage-service",children:"Storage Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get value\nconst value = await serviceRouter.invoke('storage', 'get', { key: 'myKey' });\n\n// Set value\nawait serviceRouter.invoke('storage', 'set', { key: 'myKey', value: data });\n\n// Remove\nawait serviceRouter.invoke('storage', 'remove', { key: 'myKey' });\n\n// Clear all\nawait serviceRouter.invoke('storage', 'clear', {});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"auth-service",children:"Auth Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get current user\nconst user = await serviceRouter.invoke('auth', 'getUser');\n\n// Check authentication\nconst isAuth = await serviceRouter.invoke('auth', 'isAuthenticated');\n\n// Get access token\nconst token = await serviceRouter.invoke('auth', 'getAccessToken');\n\n// Request login (triggers host login flow)\nawait serviceRouter.invoke('auth', 'requestLogin', { returnTo: 'MyScreen' });\n"})}),"\n",(0,t.jsx)(n.h3,{id:"analytics-service",children:"Analytics Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Track event\nawait serviceRouter.invoke('analytics', 'track', {\n  event: 'button_clicked',\n  properties: { button_name: 'checkout' },\n});\n\n// Track screen\nawait serviceRouter.invoke('analytics', 'screen', {\n  screenName: 'ProductDetail',\n  properties: { product_id: '123' },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"device-service",children:"Device Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get all device info\nconst info = await serviceRouter.invoke('device', 'getInfo');\n\n// Get device ID\nconst deviceId = await serviceRouter.invoke('device', 'getDeviceId');\n\n// Check if emulator\nconst isEmulator = await serviceRouter.invoke('device', 'isEmulator');\n"})}),"\n",(0,t.jsx)(n.h3,{id:"network-service",children:"Network Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get network state\nconst state = await serviceRouter.invoke('network', 'getState');\n\n// Check if online\nconst isOnline = await serviceRouter.invoke('network', 'isOnline');\n\n// Check connection type\nconst type = await serviceRouter.invoke('network', 'getConnectionType');\n"})}),"\n",(0,t.jsx)(n.h3,{id:"location-service",children:"Location Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get current position\nconst position = await serviceRouter.invoke('location', 'getCurrentPosition', {\n  options: { accuracy: 'high' },\n});\n\n// Geocode address\nconst coords = await serviceRouter.invoke('location', 'geocode', {\n  address: '123 Nguyen Hue, Quan 1',\n});\n\n// Reverse geocode\nconst address = await serviceRouter.invoke('location', 'reverseGeocode', {\n  latitude: 10.7769,\n  longitude: 106.7009,\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"media-service",children:"Media Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Take photo\nconst photo = await serviceRouter.invoke('media', 'takePhoto', {\n  options: { quality: 'high', cameraType: 'back' },\n});\n\n// Pick from gallery\nconst images = await serviceRouter.invoke('media', 'pickMultipleImages', {\n  options: { maxSelection: 5 },\n});\n\n// Crop image\nconst cropped = await serviceRouter.invoke('media', 'cropImage', {\n  uri: photo.uri,\n  options: { width: 300, height: 300 },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ui-service",children:"UI Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Show toast\nawait serviceRouter.invoke('ui', 'showToast', {\n  message: 'Saved!',\n  type: 'success',\n});\n\n// Show alert\nconst buttonIndex = await serviceRouter.invoke('ui', 'showAlert', {\n  title: 'Confirm',\n  message: 'Are you sure?',\n  buttons: [\n    { text: 'Cancel', style: 'cancel' },\n    { text: 'OK' },\n  ],\n});\n\n// Show action sheet\nawait serviceRouter.invoke('ui', 'showActionSheet', {\n  title: 'Options',\n  options: [\n    { label: 'Edit' },\n    { label: 'Delete', destructive: true },\n  ],\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"haptics-service",children:"Haptics Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Impact\nawait serviceRouter.invoke('haptics', 'impact', { style: 'medium' });\n\n// Notification\nawait serviceRouter.invoke('haptics', 'notification', { type: 'success' });\n\n// Selection\nawait serviceRouter.invoke('haptics', 'selection');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"creating-custom-handlers-host-side",children:"Creating Custom Handlers (Host Side)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// In AppProviders.tsx\nserviceRouter.register('myCustomService', {\n  doSomething: async (params, context) => {\n    const { appId } = context;\n    console.log(`Mini-app ${appId} called doSomething`);\n    return { success: true, data: 'result' };\n  },\n\n  anotherMethod: async ({ param1, param2 }) => {\n    // Process params\n    return { result: param1 + param2 };\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"try {\n  const result = await serviceRouter.invoke('service', 'method', params);\n} catch (error) {\n  if (error.code === 'SERVICE_NOT_FOUND') {\n    console.error('Service not registered');\n  } else if (error.code === 'METHOD_NOT_FOUND') {\n    console.error('Method not found');\n  } else if (error.code === 'PERMISSION_DENIED') {\n    console.error('Permission not granted');\n  } else {\n    console.error('Unknown error:', error);\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-use-sdk-over-direct-servicerouter",children:"1. Use SDK over direct serviceRouter"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Recommended\nimport { storage } from '@54vie/miniapp-sdk';\nawait storage.set('key', value);\n\n// \u26a0\ufe0f Only when needed\nimport { serviceRouter } from '@54vie/miniapp-sdk';\nawait serviceRouter.invoke('storage', 'set', { key, value });\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-handle-errors-gracefully",children:"2. Handle errors gracefully"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Good\ntry {\n  const position = await location.getCurrentPosition();\n} catch (error) {\n  // Fallback or show error\n  ui.showToast({ message: 'Cannot get location', type: 'error' });\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-check-permissions-before-using-features",children:"3. Check permissions before using features"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Good\nconst hasPermission = await auth.checkPermission('camera');\nif (!hasPermission) {\n  const granted = await auth.requestPermission('camera');\n  if (!granted) return;\n}\nconst photo = await media.takePhoto();\n"})})]})}function v(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8145(e,n,i){i.d(n,{R:()=>o,x:()=>a});var r=i(5410);const t={},s=r.createContext(t);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);