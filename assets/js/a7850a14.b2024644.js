"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[568],{4352(n,e,r){r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"api/analytics/provider","title":"AnalyticsProvider","description":"Configuration and setup for the @54vie/analytics provider component","source":"@site/docs/api/analytics/provider.md","sourceDirName":"api/analytics","slug":"/api/analytics/provider","permalink":"/api/analytics/provider","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/api/analytics/provider.md","tags":[],"version":"current","frontMatter":{"title":"AnalyticsProvider","description":"Configuration and setup for the @54vie/analytics provider component","category":"API Reference"},"sidebar":"apiSidebar","previous":{"title":"Caching","permalink":"/api/api-client/cache"},"next":{"title":"Analytics Hooks","permalink":"/api/analytics/hooks"}}');var t=r(5178),o=r(8145);const a={title:"AnalyticsProvider",description:"Configuration and setup for the @54vie/analytics provider component",category:"API Reference"},s="AnalyticsProvider",l={},c=[{value:"Installation",id:"installation",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"TypeScript Interfaces",id:"typescript-interfaces",level:2},{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Development Configuration",id:"development-configuration",level:3},{value:"Production Configuration with Custom Settings",id:"production-configuration-with-custom-settings",level:3},{value:"With Custom User ID Resolver",id:"with-custom-user-id-resolver",level:3},{value:"With Event Middleware",id:"with-event-middleware",level:3},{value:"Server-Side Rendering (Next.js)",id:"server-side-rendering-nextjs",level:3},{value:"Context Value",id:"context-value",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Related",id:"related",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"analyticsprovider",children:"AnalyticsProvider"})}),"\n",(0,t.jsxs)(e.p,{children:["The ",(0,t.jsx)(e.code,{children:"AnalyticsProvider"})," component initializes and configures the analytics context for your application. It must wrap your application at the root level to enable analytics tracking throughout your component tree."]}),"\n",(0,t.jsx)(e.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"npm install @54vie/analytics\n# or\nyarn add @54vie/analytics\n"})}),"\n",(0,t.jsx)(e.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:'import { AnalyticsProvider } from \'@54vie/analytics\';\n\nfunction App() {\n  return (\n    <AnalyticsProvider\n      apiKey="your-api-key"\n      projectId="your-project-id"\n    >\n      <YourApp />\n    </AnalyticsProvider>\n  );\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"typescript-interfaces",children:"TypeScript Interfaces"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"interface AnalyticsProviderProps {\n  /**\n   * Your 54Vie Analytics API key\n   * @required\n   */\n  apiKey: string;\n\n  /**\n   * Your project identifier\n   * @required\n   */\n  projectId: string;\n\n  /**\n   * Optional configuration options\n   */\n  config?: AnalyticsConfig;\n\n  /**\n   * Child components that will have access to analytics context\n   */\n  children: React.ReactNode;\n}\n\ninterface AnalyticsConfig {\n  /**\n   * Enable debug mode for development\n   * @default false\n   */\n  debug?: boolean;\n\n  /**\n   * Custom API endpoint URL\n   * @default 'https://api.54vie.com/v1/analytics'\n   */\n  endpoint?: string;\n\n  /**\n   * Flush events after this many milliseconds\n   * @default 10000\n   */\n  flushInterval?: number;\n\n  /**\n   * Maximum number of events to batch before flushing\n   * @default 20\n   */\n  batchSize?: number;\n\n  /**\n   * Enable automatic page view tracking\n   * @default true\n   */\n  autoTrackPageViews?: boolean;\n\n  /**\n   * Enable automatic session tracking\n   * @default true\n   */\n  autoTrackSessions?: boolean;\n\n  /**\n   * Custom session timeout in milliseconds\n   * @default 1800000 (30 minutes)\n   */\n  sessionTimeout?: number;\n\n  /**\n   * Respect user's Do Not Track browser setting\n   * @default true\n   */\n  respectDoNotTrack?: boolean;\n\n  /**\n   * Storage mechanism for persisting data\n   * @default 'localStorage'\n   */\n  storage?: 'localStorage' | 'sessionStorage' | 'memory' | 'none';\n\n  /**\n   * Cookie domain for cross-subdomain tracking\n   */\n  cookieDomain?: string;\n\n  /**\n   * Enable secure cookies (HTTPS only)\n   * @default true in production\n   */\n  secureCookies?: boolean;\n\n  /**\n   * Custom user ID resolver function\n   */\n  userIdResolver?: () => string | null | Promise<string | null>;\n\n  /**\n   * Event enrichment middleware\n   */\n  middleware?: AnalyticsMiddleware[];\n\n  /**\n   * Sampling rate for events (0.0 to 1.0)\n   * @default 1.0\n   */\n  samplingRate?: number;\n\n  /**\n   * Retry failed requests\n   * @default true\n   */\n  retryOnFailure?: boolean;\n\n  /**\n   * Maximum retry attempts\n   * @default 3\n   */\n  maxRetries?: number;\n}\n\ninterface AnalyticsMiddleware {\n  /**\n   * Unique identifier for the middleware\n   */\n  name: string;\n\n  /**\n   * Process and optionally modify events before sending\n   * Return null to drop the event\n   */\n  process: (event: AnalyticsEvent) => AnalyticsEvent | null | Promise<AnalyticsEvent | null>;\n}\n\ninterface AnalyticsEvent {\n  name: string;\n  properties?: Record<string, unknown>;\n  timestamp?: number;\n  userId?: string;\n  sessionId?: string;\n  metadata?: Record<string, unknown>;\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,t.jsx)(e.h3,{id:"development-configuration",children:"Development Configuration"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { AnalyticsProvider } from '@54vie/analytics';\n\nfunction App() {\n  return (\n    <AnalyticsProvider\n      apiKey={process.env.REACT_APP_ANALYTICS_KEY!}\n      projectId={process.env.REACT_APP_PROJECT_ID!}\n      config={{\n        debug: process.env.NODE_ENV === 'development',\n        autoTrackPageViews: true,\n        flushInterval: 5000,\n      }}\n    >\n      <YourApp />\n    </AnalyticsProvider>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"production-configuration-with-custom-settings",children:"Production Configuration with Custom Settings"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { AnalyticsProvider } from '@54vie/analytics';\n\nfunction App() {\n  return (\n    <AnalyticsProvider\n      apiKey={process.env.REACT_APP_ANALYTICS_KEY!}\n      projectId={process.env.REACT_APP_PROJECT_ID!}\n      config={{\n        debug: false,\n        endpoint: 'https://custom-analytics.yourcompany.com/v1',\n        flushInterval: 15000,\n        batchSize: 50,\n        autoTrackPageViews: true,\n        autoTrackSessions: true,\n        sessionTimeout: 3600000, // 1 hour\n        respectDoNotTrack: true,\n        storage: 'localStorage',\n        cookieDomain: '.yourcompany.com',\n        secureCookies: true,\n        samplingRate: 1.0,\n        retryOnFailure: true,\n        maxRetries: 5,\n      }}\n    >\n      <YourApp />\n    </AnalyticsProvider>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"with-custom-user-id-resolver",children:"With Custom User ID Resolver"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { AnalyticsProvider } from '@54vie/analytics';\nimport { useAuth } from './auth';\n\nfunction App() {\n  const { user } = useAuth();\n\n  return (\n    <AnalyticsProvider\n      apiKey=\"your-api-key\"\n      projectId=\"your-project-id\"\n      config={{\n        userIdResolver: async () => {\n          // Return user ID from your auth system\n          return user?.id ?? null;\n        },\n      }}\n    >\n      <YourApp />\n    </AnalyticsProvider>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"with-event-middleware",children:"With Event Middleware"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { AnalyticsProvider, AnalyticsMiddleware } from '@54vie/analytics';\n\nconst enrichmentMiddleware: AnalyticsMiddleware = {\n  name: 'enrichment',\n  process: (event) => ({\n    ...event,\n    properties: {\n      ...event.properties,\n      appVersion: '2.1.0',\n      environment: process.env.NODE_ENV,\n    },\n  }),\n};\n\nconst filterMiddleware: AnalyticsMiddleware = {\n  name: 'filter',\n  process: (event) => {\n    // Drop internal debug events in production\n    if (event.name.startsWith('debug_') && process.env.NODE_ENV === 'production') {\n      return null;\n    }\n    return event;\n  },\n};\n\nfunction App() {\n  return (\n    <AnalyticsProvider\n      apiKey=\"your-api-key\"\n      projectId=\"your-project-id\"\n      config={{\n        middleware: [enrichmentMiddleware, filterMiddleware],\n      }}\n    >\n      <YourApp />\n    </AnalyticsProvider>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"server-side-rendering-nextjs",children:"Server-Side Rendering (Next.js)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"// app/providers.tsx\n'use client';\n\nimport { AnalyticsProvider } from '@54vie/analytics';\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  return (\n    <AnalyticsProvider\n      apiKey={process.env.NEXT_PUBLIC_ANALYTICS_KEY!}\n      projectId={process.env.NEXT_PUBLIC_PROJECT_ID!}\n      config={{\n        storage: typeof window === 'undefined' ? 'memory' : 'localStorage',\n      }}\n    >\n      {children}\n    </AnalyticsProvider>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"context-value",children:"Context Value"}),"\n",(0,t.jsx)(e.p,{children:"The provider exposes the following context value to child components:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"interface AnalyticsContextValue {\n  /**\n   * Track a custom event\n   */\n  track: (eventName: string, properties?: Record<string, unknown>) => void;\n\n  /**\n   * Identify a user\n   */\n  identify: (userId: string, traits?: Record<string, unknown>) => void;\n\n  /**\n   * Set user properties\n   */\n  setUserProperties: (properties: Record<string, unknown>) => void;\n\n  /**\n   * Reset user identity (for logout)\n   */\n  reset: () => void;\n\n  /**\n   * Manually flush queued events\n   */\n  flush: () => Promise<void>;\n\n  /**\n   * Check if analytics is ready\n   */\n  isReady: boolean;\n\n  /**\n   * Check if user has opted out\n   */\n  isOptedOut: boolean;\n\n  /**\n   * Opt out of analytics tracking\n   */\n  optOut: () => void;\n\n  /**\n   * Opt back in to analytics tracking\n   */\n  optIn: () => void;\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { AnalyticsProvider, AnalyticsErrorBoundary } from '@54vie/analytics';\n\nfunction App() {\n  return (\n    <AnalyticsErrorBoundary\n      onError={(error) => {\n        console.error('Analytics error:', error);\n        // Report to error tracking service\n      }}\n      fallback={<YourApp />} // App continues working if analytics fails\n    >\n      <AnalyticsProvider\n        apiKey=\"your-api-key\"\n        projectId=\"your-project-id\"\n      >\n        <YourApp />\n      </AnalyticsProvider>\n    </AnalyticsErrorBoundary>\n  );\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/api/analytics/hooks",children:"Hooks"})," - useAnalytics, useUserProperties, useExperiment"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/api/analytics/events",children:"Events"})," - StandardEvents and custom event tracking"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/api/analytics/experiments",children:"Experiments"})," - A/B testing and feature flags"]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8145(n,e,r){r.d(e,{R:()=>a,x:()=>s});var i=r(5410);const t={},o=i.createContext(t);function a(n){const e=i.useContext(o);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);