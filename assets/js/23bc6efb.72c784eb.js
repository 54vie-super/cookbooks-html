"use strict";(globalThis.webpackChunk_54vie_cookbooks=globalThis.webpackChunk_54vie_cookbooks||[]).push([[88],{3690(n,e,i){i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"guides/push-notifications","title":"Push Notifications","description":"Guide to implement push notifications in 54VIE Super App.","source":"@site/docs/guides/push-notifications.md","sourceDirName":"guides","slug":"/guides/push-notifications","permalink":"/guides/push-notifications","draft":false,"unlisted":false,"editUrl":"https://github.com/54vie/super-app/tree/main/cookbooks/docs/guides/push-notifications.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Push Notifications"},"sidebar":"mainSidebar","previous":{"title":"Analytics Tracking","permalink":"/guides/analytics-tracking"}}');var o=i(5178),a=i(8145);const s={sidebar_position:5,title:"Push Notifications"},r="Push Notifications Guide",c={},d=[{value:"Setup",id:"setup",level:2},{value:"iOS (APNs)",id:"ios-apns",level:3},{value:"Android (FCM)",id:"android-fcm",level:3},{value:"Host App",id:"host-app",level:3},{value:"Request Permission",id:"request-permission",level:2},{value:"Topic Subscription",id:"topic-subscription",level:2},{value:"Local Notifications",id:"local-notifications",level:2},{value:"Schedule",id:"schedule",level:3},{value:"Recurring",id:"recurring",level:3},{value:"Action Buttons",id:"action-buttons",level:3},{value:"Notification Center",id:"notification-center",level:2},{value:"Deep Linking",id:"deep-linking",level:2},{value:"Android Channels",id:"android-channels",level:2},{value:"Mini-App Push",id:"mini-app-push",level:2},{value:"Server-Side Push",id:"server-side-push",level:2},{value:"Send notification",id:"send-notification",level:3},{value:"Send to topic",id:"send-to-topic",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Request permission at the right time",id:"1-request-permission-at-the-right-time",level:3},{value:"2. Provide value in notifications",id:"2-provide-value-in-notifications",level:3},{value:"3. Handle notification state",id:"3-handle-notification-state",level:3}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"push-notifications-guide",children:"Push Notifications Guide"})}),"\n",(0,o.jsx)(e.p,{children:"Guide to implement push notifications in 54VIE Super App."}),"\n",(0,o.jsx)(e.h2,{id:"setup",children:"Setup"}),"\n",(0,o.jsx)(e.h3,{id:"ios-apns",children:"iOS (APNs)"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"Enable Push Notifications capability in Xcode"}),"\n",(0,o.jsx)(e.li,{children:"Configure APNs key in Apple Developer Portal"}),"\n",(0,o.jsx)(e.li,{children:"Upload key to Firebase Console"}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"android-fcm",children:"Android (FCM)"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["Add ",(0,o.jsx)(e.code,{children:"google-services.json"})," to ",(0,o.jsx)(e.code,{children:"android/app/"})]}),"\n",(0,o.jsx)(e.li,{children:"Configure Firebase project"}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"host-app",children:"Host App"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { PushProvider } from '@54vie/push';\n\nfunction App() {\n  return (\n    <PushProvider\n      onNotificationReceived={(notification) => {\n        console.log('Received:', notification);\n      }}\n      onNotificationOpened={(notification) => {\n        handleDeepLink(notification.data);\n      }}\n    >\n      <MainApp />\n    </PushProvider>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"request-permission",children:"Request Permission"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { usePush } from '@54vie/push';\n\nfunction NotificationSetup() {\n  const { isPermissionGranted, requestPermission, token } = usePush();\n\n  useEffect(() => {\n    if (!isPermissionGranted) {\n      requestPermission();\n    }\n  }, []);\n\n  useEffect(() => {\n    if (token) {\n      // Register token with server\n      api.post('/devices/register', { token, platform: Platform.OS });\n    }\n  }, [token]);\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"topic-subscription",children:"Topic Subscription"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { pushService } from '@54vie/push';\n\n// Subscribe to topics\nawait pushService.subscribeToTopic('promotions');\nawait pushService.subscribeToTopic(`user_${userId}`);\nawait pushService.subscribeToTopic('news');\n\n// Unsubscribe\nawait pushService.unsubscribeFromTopic('promotions');\n"})}),"\n",(0,o.jsx)(e.h2,{id:"local-notifications",children:"Local Notifications"}),"\n",(0,o.jsx)(e.h3,{id:"schedule",children:"Schedule"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { useLocalNotification } from '@54vie/push';\n\nfunction OrderScreen() {\n  const { schedule, cancel } = useLocalNotification();\n\n  const schedulePickupReminder = async (orderId: string) => {\n    const notificationId = await schedule({\n      title: 'Order Ready!',\n      body: 'Your order is ready for pickup',\n      data: { orderId, action: 'pickup' },\n      scheduledAt: new Date(Date.now() + 30 * 60 * 1000), // 30 min\n    });\n\n    // Save ID to cancel later if needed\n    await storage.set(`reminder_${orderId}`, notificationId);\n  };\n\n  const cancelReminder = async (orderId: string) => {\n    const notificationId = await storage.get(`reminder_${orderId}`);\n    if (notificationId) {\n      cancel(notificationId);\n    }\n  };\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"recurring",children:"Recurring"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"// Daily reminder\nawait schedule({\n  title: 'Daily Check-in',\n  body: 'Open the app to earn points!',\n  repeatType: 'day',\n  scheduledAt: new Date().setHours(9, 0, 0), // 9 AM daily\n});\n\n// Weekly\nawait schedule({\n  title: 'Weekly Summary',\n  body: 'Check your weekly activity',\n  repeatType: 'week',\n  scheduledAt: new Date(), // Same time next week\n});\n"})}),"\n",(0,o.jsx)(e.h3,{id:"action-buttons",children:"Action Buttons"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { localNotificationService } from '@54vie/push';\n\n// Create category with actions\nawait localNotificationService.createCategory('order', [\n  { id: 'accept', title: 'Accept', destructive: false },\n  { id: 'reject', title: 'Reject', destructive: true },\n]);\n\n// Schedule with category\nawait schedule({\n  title: 'New Order',\n  body: 'Order #123 - $50.00',\n  category: 'order',\n  data: { orderId: '123' },\n});\n\n// Handle action\nPushProvider.onNotificationAction((action, notification) => {\n  if (action === 'accept') {\n    acceptOrder(notification.data.orderId);\n  } else if (action === 'reject') {\n    rejectOrder(notification.data.orderId);\n  }\n});\n"})}),"\n",(0,o.jsx)(e.h2,{id:"notification-center",children:"Notification Center"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { useNotifications, NotificationList } from '@54vie/push';\n\nfunction NotificationsScreen() {\n  const {\n    notifications,\n    unreadCount,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n  } = useNotifications();\n\n  return (\n    <View>\n      <Header>\n        <Text>Notifications ({unreadCount} unread)</Text>\n        <Button onPress={markAllAsRead}>Mark all read</Button>\n      </Header>\n\n      <NotificationList\n        notifications={notifications}\n        onPress={(notification) => {\n          markAsRead(notification.id);\n          navigateToContent(notification.data);\n        }}\n        onDelete={(notification) => {\n          deleteNotification(notification.id);\n        }}\n      />\n    </View>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"deep-linking",children:"Deep Linking"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { DeepLinkRouter } from '@54vie/push';\n\n// Register routes\nDeepLinkRouter.register('order/:orderId', ({ orderId }) => {\n  navigation.navigate('OrderDetail', { id: orderId });\n});\n\nDeepLinkRouter.register('miniapp/:appId', ({ appId, ...params }) => {\n  navigation.navigate('MiniProgram', { appId, params });\n});\n\nDeepLinkRouter.register('promo/:promoId', ({ promoId }) => {\n  navigation.navigate('PromoDetail', { id: promoId });\n});\n\n// In notification handler\nonNotificationOpened((notification) => {\n  if (notification.data?.deepLink) {\n    DeepLinkRouter.navigate(notification.data.deepLink);\n  }\n});\n"})}),"\n",(0,o.jsx)(e.h2,{id:"android-channels",children:"Android Channels"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"import { NotificationChannel } from '@54vie/push';\n\n// Create channels at app start\nNotificationChannel.create({\n  id: 'payments',\n  name: 'Payment Notifications',\n  description: 'Notifications about payments and transactions',\n  importance: 'high',\n  sound: 'payment_sound',\n  vibration: true,\n});\n\nNotificationChannel.create({\n  id: 'promotions',\n  name: 'Promotions',\n  description: 'Special offers and promotions',\n  importance: 'default',\n});\n\nNotificationChannel.create({\n  id: 'chat',\n  name: 'Messages',\n  description: 'Chat messages',\n  importance: 'high',\n  sound: 'message_sound',\n});\n"})}),"\n",(0,o.jsx)(e.h2,{id:"mini-app-push",children:"Mini-App Push"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"// In mini-app\nimport { push, useHostPush } from '@54vie/miniapp-sdk';\n\nfunction MiniAppNotifications() {\n  const { hasPermission, requestPermission } = useHostPush();\n\n  // Subscribe to mini-app specific topic\n  useEffect(() => {\n    push.subscribeToTopic(`miniapp_${MINI_APP_ID}_updates`);\n  }, []);\n\n  // Schedule local notification\n  const scheduleReminder = async () => {\n    await push.scheduleNotification({\n      title: 'Reminder from Shopping',\n      body: 'Items in your cart are selling fast!',\n      data: { miniAppId: MINI_APP_ID, action: 'view_cart' },\n      scheduledAt: new Date(Date.now() + 60 * 60 * 1000),\n    });\n  };\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"server-side-push",children:"Server-Side Push"}),"\n",(0,o.jsx)(e.h3,{id:"send-notification",children:"Send notification"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'curl -X POST https://fcm.googleapis.com/fcm/send \\\n  -H "Authorization: key=$SERVER_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "to": "$DEVICE_TOKEN",\n    "notification": {\n      "title": "New Order",\n      "body": "You have a new order!"\n    },\n    "data": {\n      "orderId": "123",\n      "deepLink": "54vie://order/123"\n    }\n  }\'\n'})}),"\n",(0,o.jsx)(e.h3,{id:"send-to-topic",children:"Send to topic"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'curl -X POST https://fcm.googleapis.com/fcm/send \\\n  -H "Authorization: key=$SERVER_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "to": "/topics/promotions",\n    "notification": {\n      "title": "Flash Sale!",\n      "body": "50% off everything for 2 hours"\n    },\n    "data": {\n      "deepLink": "54vie://promo/flash-sale"\n    }\n  }\'\n'})}),"\n",(0,o.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(e.h3,{id:"1-request-permission-at-the-right-time",children:"1. Request permission at the right time"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"// \u2705 Good - after user action or onboarding\nconst handleEnableNotifications = async () => {\n  const granted = await requestPermission();\n  if (granted) {\n    Toast.success('Notifications enabled!');\n  }\n};\n\n// \u274c Bad - immediately on app launch\nuseEffect(() => {\n  requestPermission(); // User might decline\n}, []);\n"})}),"\n",(0,o.jsx)(e.h3,{id:"2-provide-value-in-notifications",children:"2. Provide value in notifications"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"// \u2705 Good - actionable and relevant\n{\n  title: 'Your order is out for delivery',\n  body: 'Estimated arrival: 2:30 PM',\n  data: { orderId: '123', trackingUrl: '...' }\n}\n\n// \u274c Bad - generic\n{\n  title: 'Check out our app!',\n  body: 'Open now'\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"3-handle-notification-state",children:"3. Handle notification state"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-typescript",children:"// \u2705 Good - handle all states\nPushProvider\n  .onNotificationReceived(handleForeground)\n  .onNotificationOpened(handleBackground)\n  .onInitialNotification(handleColdStart);\n"})})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(l,{...n})}):l(n)}},8145(n,e,i){i.d(e,{R:()=>s,x:()=>r});var t=i(5410);const o={},a=t.createContext(o);function s(n){const e=t.useContext(a);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);